this code i got from Jean-Pierre Pommet jppommet
https://gist.github.com/jppommet